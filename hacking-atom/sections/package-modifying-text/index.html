<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>Package: Modifying Text</title>

<link rel="stylesheet" media="all" href="/assets/stylesheets/application.css" data-proofer-ignore>


  </head>
  <body>
    <div class="footer-push">
      <div class="top-bar">
  <div class="wrapper no-pad">

    <ul class="navigation">
      <li><h1 title="Atom: A hackable text editor for the 21st Century"><a href="/" class="logo-small"></a></h1></li>
      <li><a href="#" data-proofer-ignore>Packages</a></li>
      <li><a href="#" data-proofer-ignore>Themes</a></li>
      <li><a class="is-selected" href="/" data-proofer-ignore>Documentation</a></li>
      <li><a href="http://blog.atom.io">Blog</a></li>
      <li><a href="http://discuss.atom.io">Discuss</a></li>
    </ul>

  </div>
</div>

      <div class="documents-search">
  <input type="text" name="q" id="q" value="" placeholder="Search docs">
</div>
      
      <div class="wrapper documents content-push wide">
        <div class="toc">
          


<ul>
  <li>
  <h4><a href="/getting-started">Chapter 1: Getting Started</a></h4>
  <ul>
    
    
      <li class="unselected">
        <small>1.1</small>
        <a href="/getting-started/sections/why-atom">Why Atom?</a>
      </li>
      
    
      <li class="unselected">
        <small>1.2</small>
        <a href="/getting-started/sections/installing-atom">Installing Atom</a>
      </li>
      
    
      <li class="unselected">
        <small>1.3</small>
        <a href="/getting-started/sections/atom-basics">Atom Basics</a>
      </li>
      
    
      <li class="unselected">
        <small>1.4</small>
        <a href="/getting-started/sections/summary">Summary</a>
      </li>
      
    
    
  </ul>
  </li>
</ul>


<ul>
  <li>
  <h4><a href="/using-atom">Chapter 2: Using Atom</a></h4>
  <ul>
    
    
      <li class="unselected">
        <small>2.1</small>
        <a href="/using-atom/sections/atom-packages">Atom Packages</a>
      </li>
      
    
      <li class="unselected">
        <small>2.2</small>
        <a href="/using-atom/sections/moving-in-atom">Moving in Atom</a>
      </li>
      
    
      <li class="unselected">
        <small>2.3</small>
        <a href="/using-atom/sections/atom-selections">Atom Selections</a>
      </li>
      
    
      <li class="unselected">
        <small>2.4</small>
        <a href="/using-atom/sections/editing-and-deleting-text">Editing and Deleting Text</a>
      </li>
      
    
      <li class="unselected">
        <small>2.5</small>
        <a href="/using-atom/sections/find-and-replace">Find and Replace</a>
      </li>
      
    
      <li class="unselected">
        <small>2.6</small>
        <a href="/using-atom/sections/snippets">Snippets</a>
      </li>
      
    
      <li class="unselected">
        <small>2.7</small>
        <a href="/using-atom/sections/autocomplete">Autocomplete</a>
      </li>
      
    
      <li class="unselected">
        <small>2.8</small>
        <a href="/using-atom/sections/folding">Folding</a>
      </li>
      
    
      <li class="unselected">
        <small>2.9</small>
        <a href="/using-atom/sections/panes">Panes</a>
      </li>
      
    
      <li class="unselected">
        <small>2.10</small>
        <a href="/using-atom/sections/grammar">Grammar</a>
      </li>
      
    
      <li class="unselected">
        <small>2.11</small>
        <a href="/using-atom/sections/version-control-in-atom">Version Control in Atom</a>
      </li>
      
    
      <li class="unselected">
        <small>2.12</small>
        <a href="/using-atom/sections/writing-in-atom">Writing in Atom</a>
      </li>
      
    
      <li class="unselected">
        <small>2.13</small>
        <a href="/using-atom/sections/basic-customization">Basic Customization</a>
      </li>
      
    
      <li class="unselected">
        <small>2.14</small>
        <a href="/using-atom/sections/summary">Summary</a>
      </li>
      
    
    
  </ul>
  </li>
</ul>


<ul>
  <li>
  <h4><a href="/hacking-atom">Chapter 3: Hacking Atom</a></h4>
  <ul>
    
    
      <li class="unselected">
        <small>3.1</small>
        <a href="/hacking-atom/sections/tools-of-the-trade">Tools of the Trade</a>
      </li>
      
    
      <li class="unselected">
        <small>3.2</small>
        <a href="/hacking-atom/sections/the-init-file">The Init File</a>
      </li>
      
    
      <li class="unselected">
        <small>3.3</small>
        <a href="/hacking-atom/sections/package-word-count">Package: Word Count</a>
      </li>
      
    
      <li class="selected">
        <small>3.4</small>
        <a href="/hacking-atom/sections/package-modifying-text">Package: Modifying Text</a>
      </li>
      
    
      <li class="unselected">
        <small>3.5</small>
        <a href="/hacking-atom/sections/creating-a-theme">Creating a Theme</a>
      </li>
      
    
      <li class="unselected">
        <small>3.6</small>
        <a href="/hacking-atom/sections/iconography">Iconography</a>
      </li>
      
    
      <li class="unselected">
        <small>3.7</small>
        <a href="/hacking-atom/sections/debugging">Debugging</a>
      </li>
      
    
      <li class="unselected">
        <small>3.8</small>
        <a href="/hacking-atom/sections/writing-specs">Writing specs</a>
      </li>
      
    
      <li class="unselected">
        <small>3.9</small>
        <a href="/hacking-atom/sections/converting-from-textmate">Converting from TextMate</a>
      </li>
      
    
      <li class="unselected">
        <small>3.10</small>
        <a href="/hacking-atom/sections/summary">Summary</a>
      </li>
      
    
    
  </ul>
  </li>
</ul>


<ul>
  <li>
  <h4><a href="/behind-atom">Chapter 4: Behind Atom</a></h4>
  <ul>
    
    
      <li class="unselected">
        <small>4.1</small>
        <a href="/behind-atom/sections/configuration-api">Configuration API</a>
      </li>
      
    
      <li class="unselected">
        <small>4.2</small>
        <a href="/behind-atom/sections/keymaps-in-depth">Keymaps In-Depth</a>
      </li>
      
    
      <li class="unselected">
        <small>4.3</small>
        <a href="/behind-atom/sections/scoped-settings-scopes-and-scope-descriptors">Scoped Settings, Scopes and Scope Descriptors</a>
      </li>
      
    
      <li class="unselected">
        <small>4.4</small>
        <a href="/behind-atom/sections/serialization-in-atom">Serialization in Atom</a>
      </li>
      
    
      <li class="unselected">
        <small>4.5</small>
        <a href="/behind-atom/sections/developing-node-modules">Developing Node Modules</a>
      </li>
      
    
      <li class="unselected">
        <small>4.6</small>
        <a href="/behind-atom/sections/interacting-with-other-packages-via-services">Interacting With Other Packages Via Services</a>
      </li>
      
    
      <li class="unselected">
        <small>4.7</small>
        <a href="/behind-atom/sections/maintaining-your-packages">Maintaining Your Packages</a>
      </li>
      
    
      <li class="unselected">
        <small>4.8</small>
        <a href="/behind-atom/sections/summary">Summary</a>
      </li>
      
    
    
  </ul>
  </li>
</ul>


<ul>
  <li>
  <h4><a href="/upgrading-to-1-0-apis">Chapter 5: Upgrading to 1.0 APIs</a></h4>
  <ul>
    
    
      <li class="unselected">
        <small>5.1</small>
        <a href="/upgrading-to-1-0-apis/sections/upgrading-your-package">Upgrading Your Package</a>
      </li>
      
    
      <li class="unselected">
        <small>5.2</small>
        <a href="/upgrading-to-1-0-apis/sections/upgrading-your-ui-theme-or-package-selectors">Upgrading Your UI Theme Or Package Selectors</a>
      </li>
      
    
      <li class="unselected">
        <small>5.3</small>
        <a href="/upgrading-to-1-0-apis/sections/upgrading-your-syntax-theme">Upgrading Your Syntax Theme</a>
      </li>
      
    
    
  </ul>
  </li>
</ul>


        </div>
        <div class="markdown-body document-content">
          <h1>3.4 Package: Modifying Text</h1>
          <div class="manual-docs">
            <div class="sect2">
<h3 id="_package_modifying_text">Package: Modifying Text</h3>
<div class="paragraph">
<p>Now that we have our first package written, let&#8217;s go through examples of other types of packages we can make. This section will guide you though creating a simple command that replaces the selected text with <a href="https://en.wikipedia.org/wiki/ASCII_art">ascii art</a>. When you run our new command with the word "cool" selected, it will be replaced with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>                                     o888
    ooooooo     ooooooo     ooooooo   888
  888     888 888     888 888     888 888
  888         888     888 888     888 888
    88ooo888    88ooo88     88ooo88  o888o</code></pre>
</div>
</div>
<div class="paragraph">
<p>This should demonstrate how to do basic text manipulation in the current text buffer and how to deal with selections.</p>
</div>
<div class="paragraph">
<p>The final package can be viewed at <a href="https://github.com/atom/ascii-art" class="bare">https://github.com/atom/ascii-art</a>.</p>
</div>
<div class="sect3">
<h4 id="_basic_text_insertion">Basic Text Insertion</h4>
<div class="paragraph">
<p>To begin, press <code>cmd-shift-P</code> to bring up the <a href="https://github.com/atom/command-palette">Command
Palette</a>. Type "generate package" and
select the "Package Generator: Generate Package" command, just as we did in <a href="/hacking-atom/sections/package-word-count#_generate_package">Generate package</a>. Enter <code>ascii-art</code> as the name of the package.</p>
</div>
<div class="paragraph">
<p>Now let&#8217;s edit the package files to make our ASCII Art package do something interesting. Since this package doesn&#8217;t need any UI, we can remove all view-related code so go ahead and delete <code>lib/ascii-art-view.coffee</code>, <code>spec/ascii-art-view-spec.coffee</code>, and <code>styles/</code>.</p>
</div>
<div class="paragraph">
<p>Next, open up <code>lib/ascii-art.coffee</code> and remove all view code, so it looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-coffeescript" data-lang="coffeescript">{CompositeDisposable} = require 'atom'

module.exports =
  subscriptions: null

  activate: -&gt;
    @subscriptions = new CompositeDisposable
    @subscriptions.add atom.commands.add 'atom-workspace',
      'ascii-art:convert': =&gt; @convert()

  deactivate: -&gt;
    @subscriptions.dispose()

  convert: -&gt;
    console.log 'Convert text!'</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_create_a_command">Create a Command</h5>
<div class="paragraph">
<p>Now let&#8217;s add a command. It is recommended that you namespace your commands with the package name followed by a <code>:</code>, so as you can see in the code, we called our command <code>ascii-art:convert</code> and it will call the <code>convert()</code> method when it&#8217;s called.</p>
</div>
<div class="paragraph">
<p>So far, that will simply log to the console. Let&#8217;s start by making it insert something into the text buffer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-coffeescript" data-lang="coffeescript">convert: -&gt;
  if editor = atom.workspace.getActiveTextEditor()
    editor.insertText('Hello, World!')</code></pre>
</div>
</div>
<div class="paragraph">
<p>As in <a href="/hacking-atom/sections/package-word-count#_counting_words">Counting_words</a>, we&#8217;re using <code>atom.workspace.getActiveTextEditor()</code> to get the object that represents the active text editor. If this <code>convert()</code> method is called when not focused on a text editor, this will simply return a blank string, so we can skip the next line.</p>
</div>
<div class="paragraph">
<p>Next we insert a string into the current text editor with the <a href="https://atom.io/docs/api/latest/TextEditor#instance-insertText"><code>insertText()</code></a> method. This will insert the text wherever the cursor currently is in the current editor. If there is a selection, it will replace all selections with the ``Hello, World!'' text.</p>
</div>
</div>
<div class="sect4">
<h5 id="_reload_the_package">Reload the Package</h5>
<div class="paragraph">
<p>Before we can trigger <code>ascii-art:convert</code>, we need to load the latest code for our package by reloading the window. Run the command "Window: Reload" from the command palette or by pressing <code>ctrl-alt-cmd-l</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_trigger_the_command">Trigger the Command</h5>
<div class="paragraph">
<p>Now open the command panel and search for the "Ascii Art: Convert" command. But it&#8217;s not there! To fix this, open <em>package.json</em> and find the property called <code>activationCommands</code>. Activation commands speed up load time by allowing Atom to delay a package&#8217;s activation until it&#8217;s needed. So remove the existing command and use <code>ascii-art:convert</code> in <code>activationCommands</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"activationCommands": {
  "atom-workspace": "ascii-art:convert"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>First, reload the window by running the command "Window: Reload" from the command palette. Now when you run the "Ascii Art: Convert" command it will output 'Hello, World!'</p>
</div>
</div>
<div class="sect4">
<h5 id="_add_a_key_binding">Add a Key Binding</h5>
<div class="paragraph">
<p>Now let&#8217;s add a key binding to trigger the <code>ascii-art:convert</code> command. Open <em>keymaps/ascii-art.cson</em> and add a key binding linking <code>ctrl-alt-a</code> to the <code>ascii-art:convert</code> command. You can delete the pre-existing key binding since you don&#8217;t need it anymore.</p>
</div>
<div class="paragraph">
<p>When finished, the file should look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-coffeescript" data-lang="coffeescript">'atom-text-editor':
  'ctrl-alt-a': 'ascii-art:convert'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now reload the window and verify that the key binding works.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_add_the_ascii_art">Add the ASCII Art</h4>
<div class="paragraph">
<p>Now we need to convert the selected text to ASCII art. To do this we will use the <a href="https://npmjs.org/package/figlet">figlet</a> <a href="http://nodejs.org/">node</a> module from <a href="https://npmjs.org/">npm</a>. Open <em>package.json</em> and add the latest version of figlet to the dependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"dependencies": {
  "figlet": "1.0.8"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>After saving the file, run the command "Update Package Dependencies: Update" from the Command Palette. This will install the package&#8217;s node module dependencies, only figlet in this case. You will need to run "Update Package Dependencies: Update" whenever you update the dependencies field in your <em>package.json</em> file.</p>
</div>
<div class="paragraph">
<p>If for some reason this doesn&#8217;t work, you&#8217;ll see a message saying <code>`Failed to update package dependencies'' and you will find a new `npm-debug.log</code> file in your directory. That file should give you some idea as to what went wrong.</p>
</div>
<div class="paragraph">
<p>Now require the figlet node module in <em>lib/ascii-art.coffee</em> and instead of inserting 'Hello, World!', convert the selected text to ASCII art.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-coffeescript" data-lang="coffeescript">convert: -&gt;
  if editor = atom.workspace.getActiveTextEditor()
    selection = editor.getSelectedText()

    figlet = require 'figlet'
    font = "o8"
    figlet selection, {font: font}, (error, art) -&gt;
      if error
        console.error(error)
      else
        editor.insertText("\n#{art}\n")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now reload the editor, select some text in an editor window and hit <code>ctrl-alt-a</code>. It should be replaced with a ridiculous ASCII art version instead.</p>
</div>
<div class="paragraph">
<p>There are a couple of new things in this example we should look at quickly. The first is the <a href="https://atom.io/docs/api/latest/TextEditor#instance-getSelectedText"><code>editor.getSelectedText()</code></a> which, as you might guess, returns the text that is currently selected.</p>
</div>
<div class="paragraph">
<p>We then call the Figlet code to convert that into something else and replace the current selection with it with the <a href="https://atom.io/docs/api/latest/TextEditor#instance-insertText"><code>editor.insertText()</code></a> call.</p>
</div>
</div>
<div class="sect3">
<h4 id="_summary">Summary</h4>
<div class="paragraph">
<p>In this section, we&#8217;ve made a UI-less package that takes selected text and replaces it with a processed version. This could be helpful in creating linters or checkers for your code.</p>
</div>
</div>
</div>
          </div>
        </div>
      </div>
      <div class="footer-pad"></div>
    </div>
    <footer>
  <div class="footer">
    <div class="wrapper no-pad">
      <ul class="footer-left">
        <li><a href="#" data-proofer-ignore>Terms of Use</a></li>
        <li><a href="https://help.github.com/articles/github-privacy-policy/" data-proofer-ignore>Privacy</a></li>
        <li><a href="http://contributor-covenant.org/version/1/2/0" data-proofer-ignore>Code of Conduct</a></li>
        <li><a href="#" data-proofer-ignore>Releases</a></li>
        <li><a href="#" data-proofer-ignore>FAQ</a></li>
        <li><a href="#" data-proofer-ignore>Roadmap</a></li>
        <li><a href="#" data-proofer-ignore>Contact</a></li>
      </ul>

      <div class="footer-right">

      </div>
    </div>
  </div>
</footer>

  </body>
</html>
